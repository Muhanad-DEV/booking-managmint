@model BookTicketViewModel
@{
    ViewData["Title"] = "Book Ticket";
}

<h2>Book Ticket</h2>

<div class="row">
    <div class="col-md-8">
        <form asp-action="BookTicket" method="post">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            
            <input type="hidden" asp-for="EventId" />
            
            <div class="card mb-3">
                <div class="card-header">
                    <h5>@Model.EventTitle</h5>
                </div>
                <div class="card-body">
                    <p><strong>Date & Time:</strong> @Model.EventDateTime.ToString("MMM dd, yyyy HH:mm")</p>
                    <p><strong>Venue:</strong> @Model.EventVenue</p>
                    <p><strong>Price per Ticket:</strong> $@Model.EventPrice.ToString("F2")</p>
                    <p><strong>Available Seats:</strong> @Model.RemainingSeats</p>
                </div>
            </div>

            <div class="mb-3">
                <label asp-for="Quantity" class="form-label"></label>
                <input asp-for="Quantity" class="form-control" min="1" max="10" />
                <span asp-validation-for="Quantity" class="text-danger"></span>
            </div>

            <div class="mb-3">
                <strong>Total Price: $<span id="totalPrice">@((Model.Quantity * Model.EventPrice).ToString("F2"))</span></strong>
            </div>

            <div class="mb-3">
                <button type="submit" class="btn btn-primary">Confirm Booking</button>
                <a asp-action="Index" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            $('#Quantity').on('input', function() {
                var quantity = parseInt($(this).val()) || 0;
                var price = @Model.EventPrice;
                var total = (quantity * price).toFixed(2);
                $('#totalPrice').text(total);
            });
        });
    </script>
}

